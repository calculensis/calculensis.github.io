<!DOCTYPE html>
<html lang="en">
<head>
          <title>the decision blog - sentiment analysis using naive Bayes</title>
        <meta charset="utf-8" />
        <meta name="generator" content="Pelican" />
        <link href="https://calculensis.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="the decision blog Full Atom Feed" />
        <link href="https://calculensis.github.io/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="the decision blog Full RSS Feed" />
        <link href="https://calculensis.github.io/feeds/machine-learning.atom.xml" type="application/atom+xml" rel="alternate" title="the decision blog Categories Atom Feed" />




    <meta name="tags" content="naive Bayes" />

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://calculensis.github.io/">the decision blog</a></h1>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
            <li class="active"><a href="https://calculensis.github.io/category/machine-learning.html">machine learning</a></li>
            <li><a href="https://calculensis.github.io/category/productivity.html">productivity</a></li>
            <li><a href="https://calculensis.github.io/category/simple-tools.html">simple tools</a></li>
            <li><a href="https://calculensis.github.io/category/sql.html">SQL</a></li>
            <li><a href="https://calculensis.github.io/category/systems-thinking.html">systems thinking</a></li>
        </ul></nav><!-- /#menu -->
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="https://calculensis.github.io/sentiment analysis using naive Bayes.html" rel="bookmark"
         title="Permalink to sentiment analysis using naive Bayes">sentiment analysis using naive Bayes</a></h2>
 
  </header>
  <footer class="post-info">
    <time class="published" datetime="2022-12-09T00:00:00-05:00">
      Fri 09 December 2022
    </time>
    <address class="vcard author">
      By           <a class="url fn" href="https://calculensis.github.io/author/kayla-lewis.html">Kayla Lewis</a>
    </address>
    <div class="category">
        Category: <a href="https://calculensis.github.io/category/machine-learning.html">machine learning</a>
    </div>
    <div class="tags">
        Tags:
            <a href="https://calculensis.github.io/tag/naive-bayes.html">naive Bayes</a>
    </div>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p><img align=right src="images/review.jpg" width=200/></p>
<p>Suppose we want to predict whether the sentiment of an unlabeled customer review is positive or negative, based on some reviews that have already been labeled as positive or negative. One computationally fast way of doing this is to use naive Bayes classification. From Bayes' theorem the probability that a review is positive (+) based on a review (R) is
</p>
<div class="math">$$
   P(+|R) = \frac{P(R|+)P(+)}{P(R)}
$$</div>
<p>
and the probability that the review is negative (-) is given by
</p>
<div class="math">$$
   P(-|P) = \frac{P(R|-)P(-)}{P(R)}.
$$</div>
<p>
One way of avoiding having to calculate <span class="math">\(P(R)\)</span> is to consider the ratio 
</p>
<div class="math">$$
   \frac{P(+|R)}{P(-|R)}=\frac{P(R|+)P(+)}{P(R|-)P(-)}.
$$</div>
<p>
If we make the reasonable assumption that <span class="math">\(P(-)=P(+)\)</span> prior to having any evidence one way or the other, we have
</p>
<div class="math">$$
   \frac{P(+|R)}{P(-|R)}=\frac{P(R|+)}{P(R|-)},
$$</div>
<p>
and the problem has been reduced to deciding which label, positive or negative, makes the data (i.e., the reviews) more likely. </p>
<p>One simple yet useful way to encode a review in a way that we can probabilistically model it is to think of it as a "bag of words" where each word either appears in a given review or doesn't; generating a review then amounts to drawing words at random from the bag of words; such a process is captured well by a multinomial distribution: We assume that there are two multinomial distributions, one that gives rise to positive reviews and another that gives rise to negative ones; these reviews will have different parameters. The naive part of naive Bayes comes in making simplistic assumptions about these parameters. The strength of the approach is that it's fast and that it often works well if the data for each label are well-separated in feature space, which they tend to be if the dimensionality of the space is large. (And it is for the bag of words review representation.)</p>
<p>Below, we analyze a large number of labeled amazon reviews and then see if we can predict correctly the labels for a testing set. We clean the data, fit a naive multinomial Bayes model to it, and then have a look at the accuracy score and confusion matrix for the test data. (We've run the analysis before, so some of the necessary files already exist; hence the messages.) The code below can be accessed over at my <a href="https://github.com/estimatrixPipiatrix/decision-scientist.git">github</a> repository.</p>
<div class="highlight"><pre><span></span><code><span class="n">run</span> <span class="n">clean_data</span><span class="o">.</span><span class="n">py</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>train.ft.txt.bz2 already exists


bunzip2: Output file train.ft.txt already exists.
bunzip2: Output file test.ft.txt already exists.
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">run</span> <span class="n">nb_amazon</span><span class="o">.</span><span class="n">py</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">/</span><span class="nx">home</span><span class="o">/</span><span class="nx">kayla</span><span class="o">/</span><span class="nx">anaconda3</span><span class="o">/</span><span class="nx">lib</span><span class="o">/</span><span class="nx">python3</span><span class="m m-Double">.9</span><span class="o">/</span><span class="nx">site</span><span class="o">-</span><span class="nx">packages</span><span class="o">/</span><span class="nx">sklearn</span><span class="o">/</span><span class="nx">utils</span><span class="o">/</span><span class="nx">validation</span><span class="p">.</span><span class="nx">py</span><span class="p">:</span><span class="mi">993</span><span class="p">:</span><span class="w"> </span><span class="nx">DataConversionWarning</span><span class="p">:</span><span class="w"> </span><span class="nx">A</span><span class="w"> </span><span class="nx">column</span><span class="o">-</span><span class="nx">vector</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="nx">was</span><span class="w"> </span><span class="nx">passed</span><span class="w"> </span><span class="nx">when</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="mi">1</span><span class="nx">d</span><span class="w"> </span><span class="nx">array</span><span class="w"> </span><span class="nx">was</span><span class="w"> </span><span class="nx">expected</span><span class="p">.</span><span class="w"> </span><span class="nx">Please</span><span class="w"> </span><span class="nx">change</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">shape</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="p">(</span><span class="nx">n_samples</span><span class="p">,</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">example</span><span class="w"> </span><span class="nx">using</span><span class="w"> </span><span class="nx">ravel</span><span class="p">().</span>
<span class="w">  </span><span class="nx">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">column_or_1d</span><span class="p">(</span><span class="nx">y</span><span class="p">,</span><span class="w"> </span><span class="nx">warn</span><span class="p">=</span><span class="nx">True</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">run</span> <span class="n">check_results</span><span class="o">.</span><span class="n">py</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>accuracy score:  0.8417149791020628
</code></pre></div>

<p><img alt="png" src="./images/review_sentiment.png"></p>
<p>We see that with a simple model we are able to predict the out-of-sample data with 84% accuracy; the confusion matrix tells us that the model confuses good (positive) and bad (negative) reviews with one another with about equal frequency. We can use the performance of naive Bayes classifiers as a baseline against which to compare more sophisticated models if we desire higher accuracy.</p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
  </div><!-- /.entry-content -->
</section>
        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="https://getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->
</body>
</html>