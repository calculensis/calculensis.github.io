<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <title>    a graphical approach to bayes' theorem using trees
</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href='https://fonts.googleapis.com/css?family=Gentium+Book+Basic|Merriweather:400,300' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://calculensis.github.io/theme/css/cid.css">
        <link href="https://calculensis.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="the decision blog Atom Feed" />
        <link href="https://calculensis.github.io/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="the decision blog RSS Feed" />
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

            <div class="container">

<header class="blog-header">
    <h1><a href="https://calculensis.github.io">the decision blog</a></h1>
    <p></p>
    <nav>
        <a href="https://calculensis.github.io/">INDEX</a>
        <a href="https://calculensis.github.io/archives">ARCHIVES</a>
        <a href="https://calculensis.github.io/categories">CATEGORIES</a>
    </nav>
</header>

    <div class="post">

        <header>
            <h1>a graphical approach to bayes' theorem using trees</h1>
            <p class="date">Written on <time datetime="2023-03-06T00:00:00-05:00">Mar 06, 2023</time></p>
        </header>

        <article>
            <p><img align=right src="./images/harmonices.jpg" width="180"/></p>
<p>In this article I'd like to illustrate an intuitive graphical approach to using Bayes' equation, which itself is a tree diagram. As a concrete example, let's suppose you are, for some strange reason, being taught science in chronological order. You've learned all about the Ptolemaic model, which places Earth in the center of the universe; you haven't gotten to anything later yet, so this is the correct model as far as you know. </p>
<p>To make this imaginative exercise easier, let's take a moment to consider why the Ptolemaic model was at one time as persuasive as it was.</p>
<p><img src="./images/north_star.jpg" width="250"/></p>
<ul>
<li>If you look up at the north pole, all the other stars in the sky seem to make one full circle around it every 24 hours, giving the impression that the whole universe is like a great big hollow sphere with little glowing dots painted on the inside of it, which rotates as the Earth sits motionless at its center.</li>
<li>We could say that Earth is what's rotating instead, but it would have to rotate such that we would be traveling at 1,000 mph! Wouldn't we notice that? Why don't we fly off into space, like water flies off a spinning umbrella?</li>
<li>The idea of the Earth moving around the Sun seems crazy for similar reasons: If it's flying through space, why don't we fall off and get left behind?</li>
</ul>
<p>Hopefully it's a little clearer now why you might believe that the universe looks like the ancients thought it did (except for Aristarchus, the great ancient astronomer who got it right, putting the sun in the center). </p>
<p><img src="./images/orbes.jpg" width="250"/></p>
<p>There is still a problem for this model when it comes to the planets. If you watch a planet for long enough as it travels through the night sky, its path will double back on itself, as shown below.</p>
<p><img src="./images/wanderer.jpg" width="250"/></p>
<p>It's impossible to obtain a trajectory like that if the planets simply travel in circles around the Earth. In fact, the word "planet" comes from a Greek word meaning "wanderer," because the planets seem to wander aimlessly compared to the stars. One way of solving this problem is to introduce epicycles: The planet moves on the rim of a circle, the epicycle, and the center of the epicycle moves in a circle around the Earth. The planets-on-epicycles construction can reproduce the periodic, wandering retrograde motion that we observe.</p>
<p><img src="./images/epicycle.jpg" width="250"/></p>
<p>Now we fast forward from the ancient Greeks to the 17th century. The astronomer Tycho Brahe has made many measurements of the positions of the known planets as they move through the sky, and they say he's done it with unprecedented accuracy! Furthermore, a mathematician named Johannes Kepler has analyzed the data and determined that the simplest way to represent planets' motion is... to have all of them, including Earth, move along ellipses that have the sun at one focus! </p>
<p>Furthermore, Galileo has discovered the law of inertia: That the natural state of motion for an object is not to slow down and remain at rest, but to keep moving in the same direction at a constant speed. Just like, if you drop a ball while you're standing inside a train traveling on a straight track at a constant speed, it will fall straight toward your feet and not backward, in the same way we can travel along with the Earth as it flies through space without being left behind. </p>
<p>So we have some belief updating to do! Let's represent the relevant claims with letters:</p>
<p><span class="math">\(P =\)</span> The Ptolemaic system is the correct model</p>
<p><span class="math">\(K =\)</span> Kepler's system is the correct model</p>
<p>To keep things simple, we'll also suppose that one or the other of these has to be true, so if we write <span class="math">\(\sim P\)</span> to mean "<span class="math">\(P\)</span> is not true," we can also write <span class="math">\(\sim P = K\)</span>: If the Ptolemaic system isn't right, then Kepler's is (and vice versa). Also, let's write <span class="math">\(P(C)\)</span> to mean "the probability of claim <span class="math">\(C\)</span>" and <span class="math">\(P(C|E)\)</span> to mean "the probability of claim <span class="math">\(C\)</span> given evidence <span class="math">\(E\)</span>."</p>
<p>So initially we have a degree of confidence that Ptolemy's model is correct, which with our notation we can write as <span class="math">\(P(P)\)</span>, and likewise <span class="math">\(P(K)\)</span> is our initial probability that Kepler's model is correct. These probabilities are called "priors" because they represent our confidence before any new pieces of evidence (or observations) become available to us. We can represent the new observations as:</p>
<p><span class="math">\(O =\)</span> Tycho Brahe has made very many precise observations that Kepler says can be modeled more simply with his framework; Galileo has discovered the law of inertia</p>
<p>We're interested in <span class="math">\(P(P|O)\)</span> and <span class="math">\(P(K|O)\)</span>, the probabilities for each model given the new observations. Our initial confidence in the Ptolemaic model, before the new evidence is introduced, is probably pretty high, say <span class="math">\(P(P) = 0.9\)</span>; since the only other possibility is Kepler's model being correct, we have <span class="math">\(P(K) = 0.1\)</span> (the two probabilities have to sum to 1). </p>
<p>We can represent this state of affairs in the rectangle on the far left in the tree-like figure below: 90% of that rectangle is shaded green; that part represents our confidence in P. The other 10% is shaded red, corresponding to our initial confidence that K is correct.</p>
<p><img src="./images/bayes_tree.png" width="300"/></p>
<p>Branching off of that rectangle are two others, which each represent different possible epistemic universes: In the upper one, the Ptolemaic model is correct; in the lower universe Kepler's turns out to be right. Notice that the branches going to these rectangles are labeled with their respective probabilities, 0.9 and 0.1.</p>
<p><img src="./images/left_side.jpg" width="180"/></p>
<p>Now let's look at the opposite side of the figure on the far right. To shade in this rectangle (which has gray shaded regions matching the one on the left that we started with), we have to ask ourselves about P(O|P) and P(O|K), the probabilities that the observations are correct in the different universes, one in which Ptolemy is right and the other in which Kepler is right. After all, maybe Tycho Brahe took all his observations while drunk and wrote the numbers down wrong, or maybe he made some kind of measurement error, or maybe Kepler's math is wrong!</p>
<p><img src="./images/right_side.jpg" width="180"/></p>
<p>The proportion of red in the bottom part of the rectangle represents <span class="math">\(P(O|K)\)</span>, the probability that the observations are correct in the universe where the planets do move, in fact, the way Kepler describes. It would be pretty unlikely that Brahe or Kepler made serious mistakes and yet the planets move on ellipses anyway! So we set <span class="math">\(P(O|K) = 0.9\)</span> (we would probably set it even higher, but let's keep the numbers nice and simple). The shaded red region is meant to take up 90% of the area in the bottom part of the rectangle; I drew it a little larger for clarity. </p>
<p>The green shaded region of upper portion of the rectangle represents <span class="math">\(P(O|P)\)</span>, the probability that the observations are correct, but that Ptolemy's model is the correct one anyway. How might that happen? It turns out that if you add some extra epicycles - that is, make the planets travel on circles that are on circles, which then move around the Earth - you can get them to appear to move in the night sky just as Brahe's measurements indicate. </p>
<p>Of course then that model starts to look clunky, so maybe we think that's not too likely to be correct. Let's set <span class="math">\(P(O|P) = 0.1\)</span>, then. If we imagine tiling the top part of the rectangle with 10 vertical strips, the green is just one of those strips, again drawn a bit larger than it would really look, for clarity.</p>
<p>The two rectangles branching off toward the left from the one on the far right represent a universe in which the observations are correct (top branch) and one in which they are not (bottom branch). </p>
<p>Now let's look more closely at the middle rectangles. They show the overlap between the ones on each side, the area they have in common. For example, the middle top rectangle has the green area that's in common between the rectangle connected to its left and the one connected to its right side; the middle rectangle second from the top contains green that represents the overlap between the two green areas in the rectangles to which it's connected, and so on.</p>
<p><img src="./images/tree_middle.jpg" width="180"/></p>
<p>So far I haven't explained a lot of the numbers in the diagram. We start on the left, and use those numbers to get the ones on the right. The branch leading from the second upper rectangle to the upper middle one is labeled <span class="math">\(P(O|P)=0.1\)</span>. We are given that <span class="math">\(P\)</span> is true (remember, this branch represents a universe in which <span class="math">\(P\)</span> is true!) and are considering the probability that the observations are correct. This is precisely the probability that we represented on the far right rectangle by shading in 10% of its upper part. And here you can see that the thin green strip on the middle rectangle is 10% of the area of the one attached to its left. </p>
<p><img src="./images/left_side_nums.jpg" width="180"/></p>
<p>Similarly, the green in the middle rectangle second from the top is 90% of the area of the green in the rectangle connected to its left side, so that branch is labeled <span class="math">\(P(~O|P) = 0.9\)</span>. Notice that </p>
<div class="math">$$
P(O|P) + P(\sim O|P) = 0.1 + 0.9 = 1,
$$</div>
<p>and that's generally the case: The sum of two branches coming from the same rectangle must add up to 1. </p>
<p>The probabilities on the tops of the middle rectangles are joint probabilities. For example, to get to the top rectangle, two things must happen: Ptolemy's model has to be correct, <span class="math">\(P(P)=0.9\)</span>, and then the observations have to be correct, given Ptolemy's model being correct, <span class="math">\(P(O|P) = 0.1\)</span>. So the probability of both these things happening is their product: </p>
<div class="math">$$
P(P)P(O|P) = 0.09. 
$$</div>
<p>The other numbers along the middle are arrived at similarly. Now let's look at the right hand side again.</p>
<p><img src="./images/right_side_nums.jpg" width="180"/></p>
<p>The number on the upper branch coming from the far right rectangle is obtained by adding up the numbers on top of the rectangles that it ultimately connects to in the middle. That is,</p>
<div class="math">$$
P(O) = P(O\And P) + P(O\And K) = 
$$</div>
<div class="math">$$
0.09 + 0.09 = 0.18.
$$</div>
<p>Similarly,</p>
<div class="math">$$
P(\sim O) = P(\sim O \And P) + P(\sim O \And K) 
$$</div>
<div class="math">$$
= 0.81 + 0.01 = 0.82.
$$</div>
<p>Notice these two branches, since they both lead off the same rectangle, sum to 1: 0.18 + 0.82 = 1.</p>
<p>Now what about the number in yellow, <span class="math">\(P(P|O)\)</span>? We get that one by noting that the number on the top of the middle rectangle has to be <span class="math">\(P(O)P(P|O)\)</span>, just like on the left side it was <span class="math">\(P(P)P(O|P)\)</span>. So if we call that yellow number <span class="math">\(x\)</span>, we have <span class="math">\(P(O)x = P(O\And P)\)</span> or <span class="math">\(0.18x = 0.09\)</span>. Solving this equation for x gives <span class="math">\(x = 0.09/0.18 = 0.5\)</span>. The other numbers on those branches are obtained the same way. For example, if we use a <span class="math">\(y\)</span> to represent the value on the bottom, labeled <span class="math">\(P(K|~O)\)</span>, we need to have <span class="math">\(P(~O)y = P(~O\And K)\)</span> or <span class="math">\(0.82y = 0.01\)</span>, so that <span class="math">\(y = 0.01/0.82 = 0.01\)</span>. </p>
<p>So we started with confidence <span class="math">\(P(P)=0.9\)</span>, but after all that new science we find ourselves at <span class="math">\(P(P)=0.5\)</span>: We're not so sure anymore!</p>
<p>It may seem like a lot, but once you get used to it, it doesn't take long to draw up a Bayes tree and think through your confidence update for a claim, given new evidence.</p>
<p><a href="https://twitter.com/Estimatrix/status/1555693184977600512?s=20&amp;t=YFPoxpEQ2Qp14U4FliD7fA">Discuss on Twitter</a></p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
        </article>

        <footer>
            <p>This entry is posted in <a href="https://calculensis.github.io/category/simple-tools.html">simple tools</a>.</p>
        </footer>


    </div>


<footer class="blog-footer">

    <ul class="nav">
    </ul>

    <p class="disclaimer">
    Built with <a href="http://getpelican.com">Pelican</a>, and <a href="https://github.com/hdra/Pelican-Cid">Cid</a> theme.
    </p>
</footer>
            </div>
<script>
    var _gaq=[['_setAccount','UA-234119846-1'],['_trackPageview']];
    (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
    g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
    s.parentNode.insertBefore(g,s)}(document,'script'));
</script>
    </body>
</html>